<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>arduino-simple-tts: Arduino Simple TTS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">arduino-simple-tts
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Arduino Simple TTS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> Microcontrollers do not have enough resources to provide a high quality 'Text to Speech' functionality. However, often it might be good enough to provide a solution which is based on some pre-recorded audio.</p>
<p>I was wondering about the limitations of this approach and decided to implement a small prototype Arduino library that is based on the <a href="https://github.com/pschatzmann/arduino-audio-tools">Arduino Audio Tools</a> for the audio output.</p>
<p>To keep things simple I started with a simple implementation that can process numbers and on top of that another one which reads out the time. So the starting point are some classes that translate numbers to text. The text is then used to identify the pre-recorded audio files.</p>
<p>This functionality can be used e.g. to build some</p>
<ul>
<li>talking clocks</li>
<li>talking scales</li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
Conversion to Text Representation</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Numbers to Text</h2>
<p>NumberToText translates the number input into a audio_tools::Vector of words. In the following examples we just print them out:</p>
<div class="fragment"><div class="line">NumberToText ntt;</div>
<div class="line"> </div>
<div class="line">auto result = ntt.say(700123.431);</div>
<div class="line"> </div>
<div class="line">for (auto str : result){</div>
<div class="line">    Serial.print(str);</div>
<div class="line">    Serial.print(&quot; &quot;);</div>
<div class="line">}</div>
</div><!-- fragment --><p> The result is: SEVEN HUNDRED THOUSAND ONE HUNDRED AND TWENTY THREE DOT FOUR THREE ONE ZERO ZERO ZERO</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Time to Text</h2>
<p>To process the time you need to provide the hours and minuts as input.</p>
<div class="fragment"><div class="line">TimeToText ttt;</div>
<div class="line"> </div>
<div class="line">auto result = ttt.say(12, 00);</div>
<div class="line"> </div>
<div class="line">for (auto str : result){</div>
<div class="line">    Serial.print(str);</div>
<div class="line">    Serial.print(&quot; &quot;);</div>
<div class="line">}</div>
</div><!-- fragment --><p> The result is: NOON</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Numbers with Units</h2>
<p>You can also process numbers with the corresponding units </p><div class="fragment"><div class="line">NumberUnitToText utt;</div>
<div class="line"> </div>
<div class="line">auto result = utt.say(1.01,&quot;usd&quot;);</div>
<div class="line"> </div>
<div class="line">for (auto str : result){</div>
<div class="line">    Serial.print(str);</div>
<div class="line">    Serial.print(&quot; &quot;);</div>
<div class="line">}</div>
</div><!-- fragment --><p> The result is: ONE u.s. dollar AND ONE cent</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Text to Speech</h1>
<p>If we record the words in mp3 we might even get away with the need for a separate SD drive because we can store the audio in program memory. The ExampleAudioDictionaryValues contains the prerecorded mp3 files which are stored in the PROGMEM.</p>
<div class="fragment"><div class="line">#include &quot;SimpleTTS.h&quot;</div>
<div class="line">#include &quot;AudioCodecs/CodecMP3Helix.h&quot;</div>
<div class="line"> </div>
<div class="line">I2SStream i2s;  // audio output via I2S</div>
<div class="line">MP3DecoderHelix mp3;  // mp3 decoder</div>
<div class="line">AudioDictionary dictionary(ExampleAudioDictionaryValues);</div>
<div class="line">TextToSpeech tts(i2s, mp3, dictionary);</div>
<div class="line"> </div>
<div class="line">void setup(){</div>
<div class="line">    Serial.begin(115200);</div>
<div class="line">    // setup i2s</div>
<div class="line">    auto cfg = i2s.defaultConfig(); </div>
<div class="line">    cfg.sample_rate = 24000;</div>
<div class="line">    cfg.channels = 1;</div>
<div class="line">    i2s.begin(cfg);</div>
<div class="line"> </div>
<div class="line">    tts.say(&quot;BILLION&quot;);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void loop() {</div>
<div class="line">}</div>
</div><!-- fragment --><p> The word "Billion" is spoken out via I2S.</p>
<p>You can also use the text generation classes described above:</p>
<div class="fragment"><div class="line">#include &quot;SimpleTTS.h&quot;</div>
<div class="line">#include &quot;AudioCodecs/CodecMP3Helix.h&quot;</div>
<div class="line"> </div>
<div class="line">TimeToText ttt; // Text source</div>
<div class="line">I2SStream i2s;  // audio output via I2S</div>
<div class="line">MP3DecoderHelix mp3;  // mp3 decoder</div>
<div class="line">AudioDictionary dictionary(ExampleAudioDictionaryValues);</div>
<div class="line">TextToSpeech tts(ttt, i2s, mp3, dictionary);</div>
<div class="line"> </div>
<div class="line">void setup(){</div>
<div class="line">    Serial.begin(115200);</div>
<div class="line">    // setup i2s</div>
<div class="line">    auto cfg = i2s.defaultConfig(); </div>
<div class="line">    cfg.sample_rate = 24000;</div>
<div class="line">    cfg.channels = 1;</div>
<div class="line">    i2s.begin(cfg);</div>
<div class="line"> </div>
<div class="line">    ttt.say(14,40);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">void loop() {</div>
<div class="line">}</div>
</div><!-- fragment --><p> This will output the audio result via I2S.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Memory Usage</h1>
<p>Here is the info for a sketch that provides talking time and number support and stores all audio files as mp3 in PROGMEM on as ESP32: </p><div class="fragment"><div class="line">Sketch uses 740438 bytes (23%) of program storage space. Maximum is 3145728 bytes.</div>
<div class="line">Global variables use 23632 bytes (7%) of dynamic memory, leaving 304048 bytes for </div>
</div><!-- fragment --><p>I think this leave plenty of headroom and you still have the option to store the <b>audio on an SD drive</b>...</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Documentation</h1>
<p>Here is the <a href="https://pschatzmann.github.io/arduino-simple-tts/docs/html/annotated.html">link to the generated class documentation</a>. Further information can be found in the <a href="https://github.com/pschatzmann/arduino-simple-tts/wiki">Wiki</a> and in my <a href="https://www.pschatzmann.ch/home/tag/tts/">Blogs</a></p>
<h1><a class="anchor" id="autotoc_md8"></a>
Dependencies</h1>
<ul>
<li><a href="https://github.com/pschatzmann/arduino-audio-tools">Arduino Audio Tools</a> - mandatory</li>
<li><a href="https://github.com/pschatzmann/arduino-libhelix">arduino-libhelix</a> A <b>MP3 and AAC Decoder</b> from Realnetworks - mandatory if you use the mp3 of the examles</li>
<li><a href="https://github.com/greiman/SdFat">SdFat Library</a> - optional for SD examples (or you can use the SD library instead: see Wiki)</li>
<li><a href="https://github.com/pschatzmann/arduino-audiokit">Arduino AudioKit</a> - optional if you use the AudioKit (alternatively you can just replace the AudioKitStream in the examples with e.g. an I2SStream) </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
